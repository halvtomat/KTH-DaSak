import sys
import base64
from Crypto.Cipher import AES

def readall(path):
    with open(path) as f:
        return f.read()

def check(filename):
    file = readall(filename)
    p1 = readall("payload1.py")
    p2 = readall("payload2.py")
    p1 = p1[:32]
    p2 = p2[:32]
    if p1 in file:
        return 1
    if p2 in file:
        return 2
    key = file.find("key = base64.b64decode(")
    if (key != -1 and file[key+23:key+23+30].find(")") == -1):
        key = base64.b64decode(file[key+23:key+23+30])
        cipher = AES.new(key)
        if base64.b64encode(cipher.encrypt(p1)).decode()[:42] in file:
            return 1
        if base64.b64encode(cipher.encrypt(p2)).decode()[:42] in file:
            return 2
    return None

if __name__ == '__main__':
    check(sys.argv[1])
